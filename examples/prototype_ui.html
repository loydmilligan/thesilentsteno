<!DOCTYPE html>
<html lang="en" class="h-full bg-slate-900">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Silent Steno - UI Prototype</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the prototype */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple scrollbar styling for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; /* bg-slate-800 */
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; /* bg-slate-600 */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* bg-slate-500 */
        }
        /* Animation for the audio visualizer */
        .waveform-bar {
            animation: wave 1.5s infinite ease-in-out;
            transform-origin: bottom;
        }
        @keyframes wave {
            0%, 100% { transform: scaleY(0.1); }
            50% { transform: scaleY(1); }
        }
    </style>
</head>
<body class="h-full antialiased text-slate-200">
    <div id="app" class="h-full w-full max-w-4xl mx-auto flex flex-col">

        <!-- App Header (Consistent across views) -->
        <header class="flex items-center justify-between p-4 bg-slate-900/80 backdrop-blur-sm border-b border-slate-700/50 sticky top-0 z-10">
            <div id="header-left" class="flex items-center gap-4">
                 <button id="back-button" class="hidden p-2 rounded-full hover:bg-slate-700 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg>
                </button>
                <h1 id="header-title" class="text-xl font-bold text-white">Sessions</h1>
            </div>
            <div id="header-right">
                 <svg id="status-indicator" class="w-6 h-6 text-green-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 8v4l2 2"/></svg>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto p-4 md:p-6 relative">
            
            <!-- View: Session List -->
            <div id="session-list-view">
                <div id="session-list" class="space-y-4">
                    <!-- Session cards will be injected here -->
                </div>
            </div>

            <!-- View: Live Recording -->
            <div id="live-recording-view" class="hidden h-full flex flex-col items-center justify-center text-center">
                <div class="mb-8">
                    <p class="text-lg text-slate-400">Recording in Progress</p>
                    <p id="recording-timer" class="text-6xl font-bold text-white font-mono">00:00:00</p>
                </div>
                <!-- Simple audio visualizer -->
                <div class="w-full max-w-md h-32 flex items-end justify-center gap-1">
                    <!-- Bars are generated by JS -->
                </div>
                <button id="stop-recording-button" class="mt-12 bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-8 rounded-full shadow-lg transition-all">
                    Stop Recording
                </button>
            </div>

            <!-- View: Session Details -->
            <div id="session-detail-view" class="hidden">
                <div class="space-y-6">
                    <!-- Playback Controls -->
                    <div class="bg-slate-800 p-4 rounded-xl space-y-3">
                        <div class="flex items-center gap-4">
                            <button class="p-3 bg-violet-600 hover:bg-violet-700 rounded-full text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                            </button>
                            <div class="flex-1">
                                <div class="w-full h-2 bg-slate-700 rounded-full">
                                    <div class="w-1/4 h-full bg-violet-500 rounded-full"></div>
                                </div>
                            </div>
                            <span class="text-sm font-mono text-slate-400">11:48 / 47:23</span>
                        </div>
                    </div>

                    <!-- Participants -->
                    <div>
                        <h2 class="text-lg font-semibold text-white mb-2">Participants</h2>
                        <div id="detail-participants" class="flex flex-wrap gap-2">
                            <!-- Participants will be injected here -->
                        </div>
                    </div>

                    <!-- AI Summary -->
                    <div>
                        <h2 class="text-lg font-semibold text-white mb-2">AI Summary</h2>
                        <p id="detail-summary" class="bg-slate-800 p-4 rounded-xl text-slate-300 leading-relaxed"></p>
                    </div>

                    <!-- Action Items -->
                    <div>
                        <h2 class="text-lg font-semibold text-white mb-2">Action Items</h2>
                        <ul id="detail-action-items" class="bg-slate-800 p-4 rounded-xl space-y-3 list-none">
                            <!-- Action items will be injected here -->
                        </ul>
                    </div>
                    
                    <!-- Key Moments -->
                    <div>
                        <h2 class="text-lg font-semibold text-white mb-2">Key Moments</h2>
                        <div id="detail-key-moments" class="bg-slate-800 p-4 rounded-xl space-y-3">
                           <!-- Key moments will be injected here -->
                        </div>
                    </div>

                    <!-- Full Transcript -->
                    <div>
                        <button id="toggle-transcript-button" class="w-full text-left font-semibold text-white p-4 bg-slate-800 rounded-xl hover:bg-slate-700 transition-colors flex justify-between items-center">
                            <span>Full Transcript</span>
                            <svg id="transcript-chevron" class="w-5 h-5 transition-transform" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                        </button>
                        <div id="detail-transcript-container" class="hidden mt-2 bg-slate-800 p-4 rounded-xl max-h-96 overflow-y-auto">
                            <div id="detail-transcript" class="space-y-4 text-slate-300">
                                <!-- Transcript will be injected here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Floating Action Button -->
        <div id="fab-container" class="absolute bottom-6 right-6 z-20">
            <button id="record-button" class="bg-violet-600 hover:bg-violet-700 text-white p-4 rounded-full shadow-lg hover:scale-110 transition-all duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/></svg>
            </button>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DATA ---
        // Mock data, potentially from a file like sessions.json
        const mockSessions = [
          {
            "session_id": "session_20250715_103000",
            "start_time": "2025-07-15T10:30:00Z",
            "end_time": "2025-07-15T11:17:23Z",
            "duration": 2843,
            "participants": ["Alice", "Bob", "Charlie"],
            "title": "Project Alpha Kick-off",
            "summary": "The kick-off meeting for Project Alpha. Key decisions were made regarding the project timeline and initial resource allocation. The team is aligned on the next steps.",
            "action_items": [
              "Alice to finalize the project charter by EOD Friday.",
              "Bob to set up the shared repository and invite the team.",
              "Charlie to schedule the first sprint planning meeting."
            ],
            "key_moments": [
              {"timestamp": "00:05:12", "description": "Discussion on budget constraints."},
              {"timestamp": "00:15:45", "description": "Agreement on the main project milestones."},
              {"timestamp": "00:32:10", "description": "Decision on using the new design system."}
            ],
            "transcript": [
              {"speaker": "Alice", "timestamp": "00:00:15", "text": "Good morning, everyone. Thanks for joining the kick-off for Project Alpha."},
              {"speaker": "Bob", "timestamp": "00:00:20", "text": "Morning, Alice. Excited to get started."},
              {"speaker": "Charlie", "timestamp": "00:00:22", "text": "Same here. Looking forward to it."},
              {"speaker": "Alice", "timestamp": "00:00:28", "text": "Great. So, the main goal for today is to align on the project scope and the initial timeline..."},
              {"speaker": "Bob", "timestamp": "00:05:12", "text": "Speaking of scope, we should probably discuss the budget constraints early on."},
              {"speaker": "Alice", "timestamp": "00:05:25", "text": "Good point, Bob. The preliminary budget is set at $50,000 for this quarter. We need to be mindful of that."},
              {"speaker": "Charlie", "timestamp": "00:15:45", "text": "Okay, so we agree on the three main milestones for Q3. That's a solid plan."},
              {"speaker": "Alice", "timestamp": "00:32:10", "text": "And we're all in agreement to use the new design system for this project, correct? It will save us a lot of time."},
              {"speaker": "Bob", "timestamp": "00:32:18", "text": "Absolutely. It's the right call."}
            ]
          },
          {
            "session_id": "session_20250714_140000",
            "start_time": "2025-07-14T14:00:00Z",
            "end_time": "2025-07-14T14:25:11Z",
            "duration": 1511,
            "participants": ["David", "Eve"],
            "title": "Weekly Sync",
            "summary": "A quick weekly sync to review progress on current tasks. Blockers were identified and addressed. Everything is on track for the upcoming release.",
            "action_items": [
              "David to review Eve's pull request by tomorrow.",
              "Eve to deploy the latest changes to the staging environment."
            ],
            "key_moments": [
              {"timestamp": "00:02:30", "description": "Review of last week's action items."},
              {"timestamp": "00:11:05", "description": "Identification of a blocker related to API access."},
              {"timestamp": "00:18:50", "description": "Confirmation of the release schedule."}
            ],
            "transcript": [
              {"speaker": "David", "timestamp": "00:00:05", "text": "Hey Eve, how's it going?"},
              {"speaker": "Eve", "timestamp": "00:00:07", "text": "Hey David, all good. Ready for our sync."},
              {"speaker": "David", "timestamp": "00:02:30", "text": "Alright, let's start with the action items from last week. I've completed the documentation updates."},
              {"speaker": "Eve", "timestamp": "00:11:05", "text": "Okay, so I hit a bit of a blocker. I'm having trouble with the new API access token. It seems to be invalid."},
              {"speaker": "David", "timestamp": "00:18:50", "text": "Got it. Let's get that sorted. Otherwise, we're still on track for the release next Tuesday, right?"},
              {"speaker": "Eve", "timestamp": "00:18:55", "text": "Yes, once the API issue is resolved, we should be golden."}
            ]
          },
          {
            "session_id": "session_20250712_090000",
            "start_time": "2025-07-12T09:00:00Z",
            "end_time": "2025-07-12T09:15:40Z",
            "duration": 940,
            "participants": ["Frank"],
            "title": "Personal Note",
            "summary": "A personal voice note about brainstorming ideas for the Q4 marketing campaign. Focus on social media engagement and influencer collaborations.",
            "action_items": [],
            "key_moments": [
              {"timestamp": "00:01:15", "description": "Idea about a video series."},
              {"timestamp": "00:07:40", "description": "List of potential influencers."}
            ],
            "transcript": [
              {"speaker": "Frank", "timestamp": "00:00:03", "text": "Okay, just a quick note to myself. For the Q4 campaign, I really want to push the video content..."}
            ]
          }
        ];

        // --- STATE ---
        let recordingInterval;

        // --- DOM ELEMENTS ---
        const views = {
            list: document.getElementById('session-list-view'),
            recording: document.getElementById('live-recording-view'),
            detail: document.getElementById('session-detail-view')
        };
        const headerTitle = document.getElementById('header-title');
        const backButton = document.getElementById('back-button');
        const recordButton = document.getElementById('record-button');
        const stopRecordingButton = document.getElementById('stop-recording-button');
        const fabContainer = document.getElementById('fab-container');
        const sessionListContainer = document.getElementById('session-list');
        const toggleTranscriptButton = document.getElementById('toggle-transcript-button');
        const transcriptContainer = document.getElementById('detail-transcript-container');
        const transcriptChevron = document.getElementById('transcript-chevron');

        // --- RENDER FUNCTIONS ---
        
        /**
         * Switches the visible view.
         * @param {string} viewName - The name of the view to show ('list', 'recording', 'detail').
         */
        const showView = (viewName) => {
            Object.values(views).forEach(view => view.classList.add('hidden'));
            if(views[viewName]) {
                views[viewName].classList.remove('hidden');
            }
            
            // Update header and FAB visibility
            backButton.classList.toggle('hidden', viewName === 'list');
            fabContainer.classList.toggle('hidden', viewName !== 'list');
            headerTitle.textContent = viewName === 'list' ? 'Sessions' : '';
        };

        /**
         * Renders the list of all sessions.
         */
        const renderSessionList = () => {
            sessionListContainer.innerHTML = ''; // Clear existing list
            mockSessions.sort((a, b) => new Date(b.start_time) - new Date(a.start_time)).forEach(session => {
                const card = document.createElement('div');
                card.className = 'bg-slate-800 p-4 rounded-xl shadow-md cursor-pointer hover:bg-slate-700/70 transition-colors duration-200';
                card.dataset.sessionId = session.session_id;

                const date = new Date(session.start_time);
                const formattedDate = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                const durationMinutes = Math.floor(session.duration / 60);

                const participantAvatars = session.participants.map(p => 
                    `<div class="w-8 h-8 rounded-full bg-violet-500 flex items-center justify-center text-white font-bold text-sm border-2 border-slate-800 -ml-2">${p.charAt(0)}</div>`
                ).join('');

                card.innerHTML = `
                    <div class="flex justify-between items-start">
                        <h3 class="text-lg font-bold text-white mb-1">${session.title}</h3>
                        <div class="flex items-center -space-x-2">
                            ${participantAvatars}
                        </div>
                    </div>
                    <p class="text-sm text-slate-400 mb-3">${formattedDate} &bull; ${durationMinutes} min</p>
                    <p class="text-slate-300 text-sm truncate">${session.summary}</p>
                `;
                card.addEventListener('click', () => renderSessionDetail(session.session_id));
                sessionListContainer.appendChild(card);
            });
        };

        /**
         * Renders the detail view for a specific session.
         * @param {string} sessionId - The ID of the session to display.
         */
        const renderSessionDetail = (sessionId) => {
            const session = mockSessions.find(s => s.session_id === sessionId);
            if (!session) return;

            showView('detail');
            headerTitle.textContent = session.title;

            // Populate participants
            document.getElementById('detail-participants').innerHTML = session.participants.map(p => 
                `<span class="bg-slate-700 text-slate-200 px-3 py-1 rounded-full text-sm font-medium">${p}</span>`
            ).join('');

            // Populate summary
            document.getElementById('detail-summary').textContent = session.summary;

            // Populate action items
            const actionItemsList = document.getElementById('detail-action-items');
            actionItemsList.innerHTML = session.action_items.length > 0 ? session.action_items.map(item => `
                <li class="flex items-start gap-3">
                    <div class="w-5 h-5 border-2 border-slate-500 rounded mt-1 flex-shrink-0"></div>
                    <span>${item}</span>
                </li>
            `).join('') : '<li class="text-slate-400">No action items identified.</li>';
            
            // Populate key moments
            const keyMomentsContainer = document.getElementById('detail-key-moments');
            keyMomentsContainer.innerHTML = session.key_moments.length > 0 ? session.key_moments.map(moment => `
                <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-slate-700/50 cursor-pointer">
                    <div class="bg-violet-600 text-white text-xs font-mono px-2 py-1 rounded">${moment.timestamp}</div>
                    <div class="text-slate-300">${moment.description}</div>
                </div>
            `).join('') : '<p class="text-slate-400">No key moments identified.</p>';

            // Populate transcript
            const transcriptList = document.getElementById('detail-transcript');
            transcriptList.innerHTML = session.transcript.map(entry => `
                <div>
                    <p class="font-semibold text-violet-400 mb-1">${entry.speaker} <span class="text-xs text-slate-500 font-mono">${entry.timestamp}</span></p>
                    <p class="pl-2">${entry.text}</p>
                </div>
            `).join('');
            
            // Reset transcript visibility
            transcriptContainer.classList.add('hidden');
            transcriptChevron.classList.remove('rotate-180');
        };
        
        /**
         * Renders the live recording view.
         */
        const renderRecordingView = () => {
            showView('recording');
            headerTitle.textContent = 'Live Recording';
            
            // Start timer
            let seconds = 0;
            const timerEl = document.getElementById('recording-timer');
            timerEl.textContent = '00:00:00';
            recordingInterval = setInterval(() => {
                seconds++;
                const h = String(Math.floor(seconds / 3600)).padStart(2, '0');
                const m = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
                const s = String(seconds % 60).padStart(2, '0');
                timerEl.textContent = `${h}:${m}:${s}`;
            }, 1000);

            // Generate waveform bars
            const waveformContainer = document.querySelector('#live-recording-view .flex');
            waveformContainer.innerHTML = '';
            for (let i = 0; i < 40; i++) {
                const bar = document.createElement('div');
                bar.className = 'waveform-bar w-1 bg-violet-500 rounded-full';
                bar.style.animationDelay = `${Math.random() * -1.5}s`;
                bar.style.height = `${20 + Math.random() * 80}%`;
                waveformContainer.appendChild(bar);
            }
        };

        // --- EVENT HANDLERS ---
        backButton.addEventListener('click', () => {
            showView('list');
        });

        recordButton.addEventListener('click', () => {
            renderRecordingView();
        });

        stopRecordingButton.addEventListener('click', () => {
            clearInterval(recordingInterval);
            // In a real app, you'd save the recording. Here we just go back to the list.
            showView('list');
        });
        
        toggleTranscriptButton.addEventListener('click', () => {
            transcriptContainer.classList.toggle('hidden');
            transcriptChevron.classList.toggle('rotate-180');
        });

        // --- INITIALIZATION ---
        renderSessionList();
        showView('list');
    });
    </script>
</body>
</html>
